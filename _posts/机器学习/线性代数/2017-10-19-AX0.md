---
layout: post
title:  "线性代数 7 - 求解 Ax=0，主变量，特解"
categories: 线性代数
tags:  数学
mathjax: true
author: Geng
---

* content
{:toc}

列空间, 零空间的图像和概念都建立之后, 那就该从定义转到如何计算了. 





## 求解零空间 ($Ax=0$)

还是直接上例子: $3 \times 4$ 矩阵:

$$
A=
\begin{bmatrix}
1 & 2 & 2 & 2 \\
2 & 4 & 6 & 8 \\
3 & 6 & 8 & 10 
\end{bmatrix}
$$

求 $Ax=0$ 的解：

这其实就是寻找零空间的问题

### 消元法化简

使用消元法:

$$
\begin{equation}
A=
\begin{bmatrix}
1 & 2 & 2 & 2\\
2 & 4 & 6 & 8\\
3 & 6 & 8 & 10\\
\end{bmatrix}
\underrightarrow{消元}
\begin{bmatrix}
\underline{1} & 2 & 2 & 2\\
0 & 0 & \underline{2} & 4\\
0 & 0 & 0 & 0\\
\end{bmatrix}
=U
\end{equation}
$$

首先观察, 这个矩阵行列都有某些行列线性组合为其他行列的情况.

其次明确, 消元法不会改变零空间, 也就是不会改变 $Ax=b$ 的解. 


### 秩
上式中, 主元(下划线元素) 的个数为2，这个数字即矩阵 $A$ 的秩（rank）, 即$r=2$。

**秩**怎么理解呢? 我决定查字典:

    有条理，不混乱的情况：秩序。 
    古代官吏的俸禄：“官人益秩，庶人益禄”。 
    古代官职级别：委之常秩。贬秩三等。 
    十年：七秩寿辰。 

英语 rank 呢? 我也查下字典:

    排名；等级；军衔；队列
    
看到共同点了吗? 都有**等级**的意思.

为什么会有等级的意思呢? 再次观察式(1), 可以发现消元后的矩阵呈现阶梯状(echelon form), 这个阶梯有几个阶梯级数呢? 这个级数就是**等级**数目, 也就是秩(rank).

### 特解
主元所在的列为主列(pivot column), 其余列为自由列(free column).

自由列的的值可以自由或者任意分配, 所以对于式(1)对应的方程组, $x_2$ 和 $x_4$ 可以任取, 然后只需求解 $x_1$ 和 $x_3$ 即可:

如令$x_2=1, x_4=0$, 得特解
$x=c_1\begin{bmatrix}-2\\\\1\\\\0\\\\0\end{bmatrix}$;

再令$x_2=0, x_4=1$, 得特解
$x=c_2\begin{bmatrix}2\\\\0\\\\-2\\\\1\end{bmatrix}$.

这两个向量是四维空间中两条直线.



### 算法总结

* 先消元, 确定主列和自由列
* 然后对自由变量分配数值, 一般地, 令其中一个为 1, 其他均为 0

上面例子另个特解所有线性组合组成零空间. 每一个自由变量对应一个特解, 那么有多少自由变量呢? 对于 $m \times n$, 如果秩为 $r$, 自由变量就有 $n-r$ 个. 

## 简化阶梯矩阵

为了让矩阵看起来更干净, 继续简化. 变为简化行阶梯形式(reduced row echelon form, rref)，主元上下的元素都是 $0$, 主元化为 $1$：
$$
\begin{equation}
U=
\begin{bmatrix}
\underline{1} & 2 & 2 & 2\\
0 & 0 & \underline{2} & 4\\
0 & 0 & 0 & 0\\
\end{bmatrix}
\underrightarrow{化简}
\begin{bmatrix}
\underline{1} & 2 & 0 & -2\\
0 & 0 & \underline{1} & 2\\
0 & 0 & 0 & 0\\
\end{bmatrix}
=R
\end{equation}
$$

**rref**以最简单的形式包含了所有信息. 

主行其实包含了一个单位矩阵, 将 $R$ 矩阵中的主变量放在一起，自由变量放在一起（列交换），得到

$$
\begin{equation}
R=
\begin{bmatrix}
\underline{1} & 2 & 0 & -2\\
0 & 0 & \underline{1} & 2\\
0 & 0 & 0 & 0\\
\end{bmatrix}
\underrightarrow{列交换}
\left[
\begin{array}{c c | c c}
1 & 0 & 2 & -2\\
0 & 1 & 0 & 2\\
\hline
0 & 0 & 0 & 0\\
\end{array}
\right]
=
\begin{bmatrix}
I & F \\
0 & 0 \\
\end{bmatrix}
\end{equation}
$$

其中 $I$ 为单位矩阵, $F$ 为自由变量组成的矩阵

这是典型的简化行阶梯形式. 

构造一个零空间矩阵 $N$ (nullspace matrix), **它的各列由各个特解组成**, 有 $RN=0$。


$$
\begin{equation}
Ax=RN=
\begin{bmatrix}
I & F \\
0 & 0
\end{bmatrix}
\begin{bmatrix}
x_{pivot} \\
x_{free} \\
\end{bmatrix}
=0
\end{equation}
$$

则有:
$$
\begin{equation}
x_{pivot} + Fx_{free} = 0 
\\
x_{pivot}=-Fx_{free} 
\end{equation}
$$

令自由变量为 $I$, 即 $x_{free}=I$, 则根据式(4), $x_{pivot}=-F$, 那么:

$$
\begin{equation}
N=\begin{bmatrix}
-F \\
I \\
\end{bmatrix}
\end{equation}
$$
